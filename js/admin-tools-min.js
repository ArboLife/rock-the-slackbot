!function(e){"use strict";function t(t){o(),e("#rts-test-webhook-url-init").width(e("#rts-test-webhook-url-init").width()).height(e("#rts-test-webhook-url-init").height()).addClass("loading");var s=null,r=!1;e.ajax({url:ajaxurl,type:"POST",dataType:"json",async:!0,cache:!1,data:{action:"test_webhook_url",webhook_url:t,channel:e("#rts-webhook-channel").val()},success:function(e){void 0!==e.error&&""!=e.error?(r=!1,s=rock_the_slackbot.webhook_test_responses.error):void 0!==e.sent&&e.sent>0?(r=!0,s=rock_the_slackbot.webhook_test_responses.success):(r=!1,s=rock_the_slackbot.webhook_test_responses.failed)},complete:function(t,o){var n=null;r?(n=e('<span class="rts-response rts-response-success">'+s+"</span>"),e("#rts-test-webhook-url-init").removeClass("button-primary"),e("#rts-test-webhook-url-close").html(rock_the_slackbot.close)):n=e('<span class="rts-response rts-response-fail">'+s+"</span>"),e("#rts-popup-test-webhook-message").append(" ").append(n),e("#rts-test-webhook-url-init").html("<span>"+rock_the_slackbot.webhook_send_another+"</span>"),e("#rts-test-webhook-url-init").removeClass("loading").removeAttr("style")}})}function s(){var t=e("#rts-webhook-url-input"),s=t.closest(".rts-field"),o=t.closest(".rts-input-button-combo");t.val().match(/^http/i)?(s.removeClass("rts-field-error").removeClass("rts-field-is-invalid"),o.addClass("show-button")):(o.removeClass("show-button"),""!=t.val()?s.addClass("rts-field-error").addClass("rts-field-is-invalid"):s.removeClass("rts-field-is-invalid"))}function o(){var t=e("#rts-popup-test-webhook-url");t.find(".rts-response").remove(),e("#rts-test-webhook-url-init").html("<span>"+rock_the_slackbot.webhook_send_test+"</span>").addClass("button-primary"),e("#rts-test-webhook-url-close").html(rock_the_slackbot.cancel)}e(document).ready(function(){e(".rts-tooltip").tooltip(),e(".rts-field.rts-field-required").each(function(){var t=e(this);t.find(".rts-input-required").on("keyup change",function(){""!=e(this).val()?t.removeClass("rts-field-error").removeClass("rts-field-is-blank"):t.addClass("rts-field-error").addClass("rts-field-is-blank")})});var r=e("#rts-webhook-url-input");s();var n,i=500;r.on("keyup",function(){clearTimeout(n),n=setTimeout(s,i)}),r.on("keydown",function(){clearTimeout(n)}),r.on("change",function(){s()}),e(".rts-close-thickbox").on("click",function(e){e.preventDefault(),tb_remove(),setTimeout(o,1e3)}),e(document).on("keyup",function(e){27==e.keyCode&&o()}),e("#rts-test-webhook-url-init").on("click",function(e){e.preventDefault(),t(r.val())}),e(".rts-events .rts-event-choice").each(function(){var t=e(this);t.rts_check_event_choice(),e(this).find(".rts-event-choice-active-field").on("change",function(){t.rts_check_event_choice()})}),e("#rts-select-all-events").on("click",function(t){t.preventDefault(),e(this).hasClass("all-selected")?(e(this).removeClass("all-selected"),e(".rts-events .rts-event-choice .rts-event-choice-active-field").prop("checked",!1).trigger("change")):(e(this).addClass("all-selected"),e(".rts-events .rts-event-choice .rts-event-choice-active-field").prop("checked",!0).trigger("change"))}),e("#rock-slackbot-delete-button").on("click",function(e){var t=confirm(rock_the_slackbot.delete_webhook_conf);1!=t&&e.preventDefault()})}),e.fn.rts_check_event_choice=function(){var t=e(this).find(".rts-event-choice-active-field");t.is(":checked")?e(this).addClass("rts-choice-is-active"):e(this).removeClass("rts-choice-is-active")}}(jQuery);